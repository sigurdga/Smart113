{% extends "base.html" %}
{% load i18n %}
{% load webdesign %}

{% block content %}


{% if request.user.is_authenticated %}

<div class="hero-unit">
    <h1>{% trans "Emergency help" %}</h1>
    <p>{% trans "When clicking this, you will contact the emergency center." %}</p>
    <a class="btn btn-danger btn-large">{% trans "Emergency" %}</a>
    <div><span id="position"></span> <span id="address"></span></div>
</div>

<div class="page-header">
    <h1>{% trans "Update information" %}
        <small>{% trans "Please keep all information updated, it helps us, when we help you." %}</small>
    </h1>
</div>

<p>{% trans "Keep in mind that these are the people you are most likely calling emergency about" %}</p>

<h2><a href="{% url profile-basic %}">{% trans "You" %}</a></h2>
{% with request.user.profile as profile %}
<p>{% trans "Information about yourself" %} (ektefelle, samboer, osv vil dukke opp ved siden av)</p>
<ul class="thumbnails">
    <li class="span3">
    <div class="thumbnail">
        {% if profile.image %}
        <img src="{{ profile.image.url }}">
        {% endif %}
        <h5>{{ request.user.name }}</h5>
        <p>
        {% if profile.gender %}
        {{ profile.get_gender_display }},
        {% endif %}
        {% if profile.birth_date %}
        {{ profile.age }}
        {% trans "years old" %}
        {% endif %}
        </p>
    </div>
    </li>
</ul>
{% endwith %}

<h2>{% trans "Children" %}</h2>
<p>{% trans "Children and other you are responsible for" %}</p>

<h2>{% trans "Parents" %}</h2>
<p>{% trans "Parents and grandparents" %}</p>

<h2>{% trans "Neighbours, etc" %}</h2>
<p>Blablabla</p>

<h2>{% trans "Colleagues, etc" %}</h2>
<p>Blablabla</p>

{% else %}

<div class="hero-unit">
    <h1>{% trans "Circumventing bureaucracy when it matters the most" %}</h1>
    <p>{% trans "A very short introduction" %}</p>
    <a class="btn btn-success btn-large" href="">{% trans "Take the tour" %}</a>
    <div class="pull-right">
        <a class="btn" href="{% url socialauth_begin 'google' %}">{% trans "Log in using Google" %}</a>
    </div>

</div>



{% endif %}

<div class="page-header">
    <h1>{% trans "About" %}
        <small>{% trans "What is all this about" %}</small>
    </h1>
</div>

{% lorem 3 p random %}

{% endblock %}

{% block inlinejs %}
{% if request.user.is_authenticated %}

$(document).ready(function () {

    navigator.geolocation.getCurrentPosition(show_map);

    function show_map(position) {
      var latitude = position.coords.latitude;
      var longitude = position.coords.longitude;
      // let's show a map or do something interesting!
      console.log(latitude);
      console.log(longitude);
      $('#position').text('Position: ' + longitude + ', ' + latitude);
      //latitude = "59.92";
      //longitude = "10.71"
      $.getJSON('{{ request.path_info }}profile/p/' + latitude + '/' + longitude, function(data) {
            var response = jQuery.parseJSON(data);
            if (!response.info.statuscode && response.results)Â {
                var result = response.results[0];
                if (result.locations) {
                    var location = result.locations[0];
                    var locationarr = [];
                    if (location.adminArea5) {
                        locationarr.push(location.adminArea5);
                    }
                    if (location.adminArea4) {
                        locationarr.push(location.adminArea4);
                    }
                    if (location.adminArea3) {
                        locationarr.push(location.adminArea3);
                    }
                    if (location.adminArea1) {
                        locationarr.push(location.adminArea1);
                    }

                    if (locationarr) {
                        $('#address').text(' near ' + locationarr.join(", "));
                    }
                }
            }
          console.log(jQuery.parseJSON(data));
      });
    }

    function renderReverse(position_string) {
        $('#position').text("Oslo, Norway");
    }
});
{% endif %}
{% endblock %}
